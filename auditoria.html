<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Auditoria</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <nav>
      <ul class="menu">
        <li><a href="painel.html">ğŸ  InÃ­cio</a></li>
        <li><a href="analise.html">ğŸ“Š AnÃ¡lise</a></li>
        <li><a href="auditoria.html">ğŸ“ Auditoria</a></li>
        <li><a href="planos.html">ğŸ’¼ Planos</a></li>
        <li><a href="#" onclick="logout()">ğŸšª Sair</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <h1>Auditoria de AnÃºncios</h1>

    <section class="auditoria-form">
      <input type="text" id="input-anuncio" placeholder="Cole aqui a URL do anÃºncio da Shopee">
      <button onclick="enviarAuditoria()">Auditar AnÃºncio</button>
      <div id="resposta" class="resultado"></div>
    </section>
  </main>

  <script>
    async function enviarAuditoria() {
      const input = document.getElementById("input-anuncio").value.trim();
      const resposta = document.getElementById("resposta");

      if (!input) {
        resposta.innerText = "Por favor, cole a URL do anÃºncio.";
        return;
      }

      resposta.innerText = "ğŸ” Analisando com IA, aguarde...";

      try {
        const res = await fetch("https://shopee-pro-backend.onrender.com/auditar", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ url: input })
        });

        const dados = await res.json();

        if (res.ok) {
          resposta.innerHTML = `
            <strong>Nota:</strong> ${dados.nota}<br>
            <strong>Feedback:</strong><br>${dados.feedback.replace(/\n/g, "<br>")}
          `;
        } else {
          resposta.innerText = dados.erro || "Erro ao processar anÃ¡lise.";
        }
      } catch (e) {
        console.error(e);
        resposta.innerText = "Erro de conexÃ£o com o servidor.";
      }
    }

    function logout() {
      localStorage.removeItem("uid");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
